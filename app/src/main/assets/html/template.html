<html>
<head>
    <script src='file:///android_asset/html/jquery.min.js'></script>
    <style type="text/css">
        @font-face { font-family: Chivo-Regular; src: url('file:///android_asset/fonts/Chivo-Regular.ttf');}
        @font-face { font-family: OpenSans-Regular; src: url('file:///android_asset/fonts/OpenSans-Regular.ttf');}
        @font-face { font-family: Roboto-Mono-Regular; src: url('file:///android_asset/fonts/Roboto-Mono-Regular.ttf');}

        body {
            margin: 0;
            padding: 0;
        }

        img {
            max-width: 100% !important;
            max-height: 100% !important;
        }

        #container {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        #content {
            position: relative;
            text-align: justify;
        }

        #bottom {
            text-align: center;
        }

        #page {
            display: inline-block;
            color: #999999;
            margin: 5px 0px 5px 0px;
            font-size: 16px;
        }

        #hider {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="hider"></div>
    <div id="container">
        <div id="content">
            ${content}<span id="end_marker"></span>
        </div>
        <div id="bottom">
            <span id="page"></span>
        </div>
    </div>

    <script type="text/javascript">
        var columnWidth;
        var columnGap;
        var columnCount;

    	function setPage(page) {
        	$('#content').css('left', -1 * (page - 1) * (columnWidth + columnGap));
        	$('#page').html('&equiv;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + page + " / " + columnCount + '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&equiv;');
        }

        function init(font_family, font_size, font_color, background_color, margin, page) {
            $('#hider').css('background-color', background_color);

            // settings
            $('#container').css('font-family', "'" + font_family + "'");
            $('#content').css('font-size', font_size + 'px !important');
            $('#content').css('color', font_color);
            $('#container').css('background-color', background_color);

            // margin
            columnGap = margin * 2;
            var marginBottom = margin * 2;
            $('#content').css({
                'margin-top': margin + 'px',
                'margin-left': margin + 'px',
                'margin-right': margin + 'px',
                'margin-bottom': '0px'
            });

            // column
            $('#content').css({
                '-webkit-column-gap': columnGap + 'px',
                '-moz-column-gap': columnGap + 'px',
                'column-gap': columnGap + 'px'
            });

            columnWidth = document.getElementById('content').offsetWidth;

            $('#content').css({
                'height': window.innerHeight - marginBottom + 'px',
                '-webkit-column-width': columnWidth + 'px',
                '-moz-column-width': columnWidth + 'px',
                'column-width': columnWidth + 'px'
            });

            columnCount = Math.ceil($('#end_marker').offset().left / (columnWidth + columnGap));

            if (page == -1) {
                page = columnCount;
            }
            setPage(page);
            android.onSetPageCount(columnCount);
            $('#hider').hide();
        }

        // selection
        $('#content').on('click', function(event) {
            var s = window.getSelection();
            s.modify('move','backward', 'word');
            s.modify('extend','forward', 'word');
            if (s.toString() != '') {
                android.onTextSelected(s.toString());
            }
            s.modify('move','forward', 'character');
        });

        // menu
        $('#bottom').on('click', function(event) {
            android.onMenuClicked();
        });
    </script>
</body>
</html>