<span id="end_marker"></span></div>

<script>

        function init(font_family, font_size, font_color, background_color, page) {
            $('#content').css('font-family', "'" + font_family + "'");
            $('#content').css('font-size', font_size + 'px');
            $('#content').css('color', font_color);
            $('#fill_screen').css('background-color', background_color);
            $('body').css('background-color', background_color);

            var columnGap = 2;
            var ourHeight = window.innerHeight;
            var ourWidth = window.innerWidth;
            var fullHeight = $('#end_marker').offset().top;
            var pageCount = Math.floor(fullHeight / ourHeight) + 1;
            var newWidth = pageCount * ourWidth;

            $('body').css({
                'height': ourHeight + 'px',
                'width': newWidth + 'px',
                '-webkit-column-gap': columnGap + 'px',
                'column-gap': columnGap + 'px',
                'column-count': pageCount
            });

            var wait_here = setInterval(function() {
                if ($('body').css('column-count') == pageCount) {
                    clearInterval(wait_here)

                    $('body').scrollLeft(window.innerWidth * page);
                    $('#fill_screen').hide();
                    var columnCount = Math.ceil($('#end_marker').offset().left / (ourWidth));
                    android.getPageCount(columnCount);
                }
            }, 50);
        }

        function setPage(page) {
            $('body').scrollLeft(window.innerWidth * page);
        }

        document.onclick = globalOnClickHandler;
        function globalOnClickHandler() {
            var s = window.getSelection();
            s.modify('move','backward', 'word');
            s.modify('extend','forward', 'word');
            if (s.toString() != '') {
                android.onTextSelected(s.toString());
            }
        }
    </script>
</body>
</html>